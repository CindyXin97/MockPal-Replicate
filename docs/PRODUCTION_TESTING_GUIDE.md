# MockPal 生产环境测试指南 🚀

本指南专门针对 **www.mockpals.com** 生产环境的安全测试，确保在不影响题库和真实用户数据的前提下进行全面测试。

## ⚠️ 重要安全提醒

🔒 **题库绝对安全**: 所有清理脚本都经过特殊设计，绝不会触碰 `interview_questions` 表  
🛡️ **真实用户保护**: 只清理明显的测试数据，保护真实用户  
✅ **多重安全检查**: 需要明确确认参数才能执行生产环境操作

## 🧹 生产环境安全清理

### 基础清理（推荐）
```bash
# 清理测试数据，保留所有用户和题库
npm run clear-prod-data -- --confirm-production
```

### 深度清理（谨慎使用）
```bash
# 额外清理测试账户资料
npm run clear-prod-data -- --confirm-production --clear-test-profiles

# 清理测试账户（只删除email包含test/demo的账户）
npm run clear-prod-data -- --confirm-production --clear-test-users
```

## 📋 生产环境测试流程

### 第一阶段：准备测试环境

1. **备份检查** ✅
   ```bash
   # 确认题库数据完整性
   npm run clear-prod-data -- --confirm-production
   # 查看题库统计，确保数量正确
   ```

2. **创建测试账户** 🔐
   - 使用明显的测试邮箱（如 `test1@example.com`）
   - 用户名包含"测试"或"test"
   - 不要使用真实邮箱

### 第二阶段：核心功能测试

#### 1. 用户认证系统 🔑
- [ ] **Google OAuth登录**
  - 测试Google账号登录
  - 验证用户信息正确导入
  - 检查profile自动创建

- [ ] **邮箱魔法链接登录**
  - 测试邮箱登录链接
  - 验证邮件发送功能（Resend）
  - 检查链接有效性

#### 2. 用户资料管理 👤
- [ ] **资料完善测试**
  - 填写完整的用户资料
  - 测试所有字段保存
  - 验证LinkedIn字段显示

- [ ] **数据持久化**
  - 刷新页面检查数据保存
  - 跨设备登录验证

#### 3. 匹配系统核心测试 🎯
- [ ] **推荐算法**
  - 创建不同类型的测试账户
  - 验证匹配推荐的准确性
  - 测试每日5人浏览限制

- [ ] **匹配操作**
  - 测试喜欢/跳过功能
  - 验证双向匹配成功
  - 检查匹配通知

#### 4. 反馈系统重点测试 📝
- [ ] **表单持久化**（新功能）
  - 填写反馈表单
  - 刷新页面验证数据保持
  - 测试localStorage功能

- [ ] **提交后折叠**（新功能）
  - 提交反馈后检查卡片折叠
  - 验证已提交状态显示
  - 测试修改功能

#### 5. 联系方式显示 📞
- [ ] **LinkedIn显示**（新修复）
  - 在用户资料中填写LinkedIn
  - 匹配成功后检查LinkedIn显示
  - 验证联系模板生成

#### 6. 成就系统 🏆
- [ ] **等级计算**
  - 完成面试获得经验值
  - 验证等级提升
  - 检查成就显示

#### 7. 面试真题功能 📚
- [ ] **题库完整性**
  - 确认所有题目正常显示
  - 测试筛选功能
  - 验证题目内容完整

### 第三阶段：性能和用户体验测试

#### 1. 页面加载性能 ⚡
```bash
# 使用浏览器开发者工具测试
- 首页加载时间 < 3秒
- 匹配页面加载 < 2秒
- 图片懒加载正常
```

#### 2. 移动端适配 📱
- [ ] 在手机上测试所有功能
- [ ] 检查响应式布局
- [ ] 验证触摸交互

#### 3. 跨浏览器兼容性 🌐
- [ ] Chrome测试
- [ ] Safari测试  
- [ ] Firefox测试
- [ ] 移动浏览器测试

### 第四阶段：安全性测试

#### 1. 认证安全 🔐
- [ ] 未登录用户重定向
- [ ] 会话超时处理
- [ ] 权限控制验证

#### 2. 数据安全 🛡️
- [ ] 敏感信息保护
- [ ] API接口权限验证
- [ ] 表单输入验证

## 🔍 关键测试点

### 新功能验证
1. **反馈持久化** - 重点测试localStorage保存和恢复
2. **LinkedIn显示** - 验证联系方式完整显示
3. **卡片折叠** - 确认提交后UI正确更新

### 性能监控
```javascript
// 在浏览器Console中运行
console.time('页面加载');
window.addEventListener('load', () => {
  console.timeEnd('页面加载');
});
```

### 数据完整性检查
- 题库数量保持不变
- 用户数据正确保存
- 匹配算法准确运行

## 📊 生产环境测试报告模板

```
测试日期: [日期]
测试环境: https://www.mockpals.com
测试人员: [姓名]

=== 题库安全检查 ===
题库数量: [数量] ✅ 完整无损

=== 功能测试结果 ===
✅ 用户认证: 正常
✅ 资料管理: 正常  
✅ 匹配系统: 正常
✅ 反馈系统: 正常（新功能）
✅ LinkedIn显示: 正常（新修复）
✅ 成就系统: 正常
✅ 面试真题: 正常

=== 性能测试 ===
首页加载: [时间]ms
匹配页面: [时间]ms
移动端: ✅ 正常

=== 发现问题 ===
[列出发现的问题]

=== 建议改进 ===
[提出改进建议]
```

## 🚀 测试最佳实践

### 测试前准备
1. 确保有稳定的网络连接
2. 准备多个测试邮箱账户
3. 使用无痕模式避免缓存干扰

### 测试中注意
1. **记录每个步骤** - 便于问题复现
2. **截图保存** - 重要功能的测试结果
3. **性能监控** - 使用开发者工具监控

### 测试后清理
```bash
# 清理测试数据（保留题库）
npm run clear-prod-data -- --confirm-production --clear-test-profiles
```

## 🛠️ 调试工具

### 浏览器开发者工具
- **Network**: 监控API请求和响应时间
- **Application**: 检查localStorage数据
- **Console**: 查看错误和调试信息
- **Performance**: 分析页面性能

### 有用的Console命令
```javascript
// 检查localStorage中的反馈数据
Object.keys(localStorage).filter(key => key.includes('mockpal_feedback'))

// 监控网络请求
performance.getEntriesByType('navigation')[0]

// 检查当前用户会话
document.cookie
```

## ⚠️ 紧急情况处理

如果测试过程中发现严重问题：

1. **立即停止测试**
2. **记录问题详情**
3. **联系开发团队**
4. **如需回滚，使用数据库备份**

## 📞 支持联系

- 技术问题：检查GitHub Issues
- 紧急情况：立即联系开发团队
- 功能建议：创建Feature Request

---

**记住**: 生产环境测试的目标是验证功能正常，而不是压力测试。请始终以用户体验为中心进行测试！🎯 