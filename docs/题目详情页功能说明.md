# 题目详情页功能说明 📝

## ✅ 已完成的改进

### 新的交互体验

之前：在题库列表页面展开/折叠查看题目  
现在：**点击题目卡片 → 跳转到独立详情页 → 深度讨论**

---

## 🎯 新功能特性

### 1. 题目列表页（改进）

**页面路径**：`/matches` → 面试真题 tab

**新的交互**：
- ✅ 题目卡片现在可以点击
- ✅ 鼠标悬停时有阴影放大效果
- ✅ 显示问题预览（最多3行）
- ✅ 底部显示统计信息：
  - 👍 点赞数
  - 👎 踩数
  - 💬 评论数
  - "点击查看详情 →"
- ✅ 移除了展开/折叠功能（现在直接跳转）

### 2. 题目详情页（全新）

**页面路径**：`/questions/[postType]/[id]`
- 系统题目：`/questions/system/123`
- 用户题目：`/questions/user/456`

**页面布局**：

```
┌─────────────────────────────────────┐
│  ← 返回题库                         │
├─────────────────────────────────────┤
│  【题目详情卡片】                    │
│  - 公司、岗位、年份                 │
│  - 难度、类型标签                   │
│  - 完整题目内容                     │
│  - 推荐答案（如有）                 │
│  - 点赞/踩按钮                      │
├─────────────────────────────────────┤
│  【讨论区卡片】                     │
│  - 评论输入框                       │
│  - 所有评论列表（默认展开）         │
│  - 评论时间、用户信息               │
└─────────────────────────────────────┘
```

**功能详情**：

#### 📌 标签展示
- 🟢 "我的发布"（用户自己的帖子）
- 🟣 "用户分享"（其他用户的帖子）
- 🟡/🟢/🔴 难度标签
- 题目类型图标

#### 📝 内容展示
- 完整的题目描述（不截断）
- 推荐答案（美观的蓝色背景框）
- 来源信息
- 分享者信息（如不匿名）

#### 👍👎 投票功能
- 显示点赞数、踩数
- 显示总分（点赞 - 踩）
- 用户投票状态高亮
- 可以切换或取消投票

#### 💬 讨论区
- **默认展开**（不需要点击）
- 评论输入框在顶部
- 字数统计（/1000）
- 评论列表按时间倒序
- 显示评论者头像（首字母）
- 显示评论者名称
- 相对时间显示（刚刚/X分钟前/X小时前）

---

## 🔄 工作流程

### 用户浏览题目
```
1. 访问题库页面
2. 浏览题目列表（看到预览）
3. 点击感兴趣的题目
   ↓
4. 跳转到详情页
5. 阅读完整题目和答案
6. 点赞或踩
7. 在评论区参与讨论
8. 点击"返回题库"继续浏览
```

### 用户发表评论
```
1. 在详情页底部看到评论区
2. 在输入框输入评论（最多1000字）
3. 点击"发布评论"
4. 评论立即显示在列表顶部
5. 可以看到其他用户的评论
```

---

## 📁 文件结构

### 新增文件

```
app/
├── questions/
│   └── [postType]/
│       └── [id]/
│           └── page.tsx          # 题目详情页
└── api/
    └── question-detail/
        └── route.ts               # 获取题目详情 API
```

### 修改文件

```
app/matches/page.tsx              # 题目列表页（改为点击跳转）
components/comment-section.tsx    # 评论组件（支持默认展开）
```

---

## 🎨 UI/UX 改进

### 题目列表页
- ✅ **卡片悬停效果** - shadow-lg + 过渡动画
- ✅ **鼠标指针** - cursor-pointer 显示可点击
- ✅ **内容预览** - line-clamp-3 限制3行
- ✅ **统计信息** - 底部显示互动数据
- ✅ **视觉引导** - "点击查看详情 →" 蓝色文字

### 详情页
- ✅ **返回按钮** - 左上角明显位置
- ✅ **卡片布局** - 清晰的层次结构
- ✅ **颜色区分** - 
  - 题目：灰色背景
  - 答案：蓝色背景
  - 评论：白色卡片
- ✅ **响应式设计** - 最大宽度 4xl（1024px）
- ✅ **加载状态** - 骨架屏动画
- ✅ **空状态** - 友好的404页面

---

## 🔌 API 设计

### GET `/api/question-detail`

**查询参数**：
```
postType: 'system' | 'user'
postId: number
```

**返回数据**：
```json
{
  "success": true,
  "data": {
    "id": 123,
    "company": "Google",
    "position": "数据分析师",
    "questionType": "technical",
    "difficulty": "medium",
    "question": "题目内容...",
    "recommendedAnswer": "推荐答案...",
    "year": 2024,
    "postType": "system",
    "isOwnPost": false,
    "stats": {
      "upvotes": 15,
      "downvotes": 2,
      "score": 13,
      "comments": 8,
      "views": 120
    },
    "userVote": "up"
  }
}
```

**错误处理**：
- 404: 题目不存在
- 400: 参数错误
- 500: 服务器错误

---

## 🚀 优势分析

### 对比之前的设计

| 特性 | 之前 | 现在 |
|------|------|------|
| 浏览体验 | 列表中展开/折叠 | 点击跳转到详情页 |
| 讨论空间 | 挤在列表页 | 独立页面，空间充足 |
| URL分享 | ❌ 无法分享特定题目 | ✅ 每个题目有独立URL |
| SEO | ❌ 所有内容在一个页面 | ✅ 每个题目独立页面 |
| 性能 | 列表页加载所有评论 | 按需加载，性能更好 |
| 导航 | 需要滚动查找 | 直接跳转，返回方便 |

### 用户体验提升

1. ✅ **清晰的层次** - 列表→详情，符合直觉
2. ✅ **专注阅读** - 详情页不受列表干扰
3. ✅ **深度讨论** - 评论区有充足空间
4. ✅ **便于分享** - 可以直接分享题目链接
5. ✅ **性能优化** - 列表页只加载预览

---

## 🔮 未来扩展

详情页架构便于添加更多功能：

- ⏳ 相关题目推荐
- ⏳ 分享到社交媒体
- ⏳ 收藏功能
- ⏳ 编辑/删除自己的帖子
- ⏳ 举报不当内容
- ⏳ 题目浏览历史
- ⏳ 打印/导出功能
- ⏳ 题目标签系统

---

## ✅ 测试清单

使用前请测试：

- [ ] 点击题目卡片能跳转到详情页
- [ ] 详情页显示完整内容
- [ ] 返回按钮能回到列表页
- [ ] 点赞/踩功能正常
- [ ] 评论区默认展开
- [ ] 可以发表评论
- [ ] 评论实时显示
- [ ] 404页面正常显示（访问不存在的题目）
- [ ] 加载状态动画正常
- [ ] 移动端显示正常

---

## 🎉 总结

新的详情页设计：
1. ✅ 更好的用户体验 - 清晰的导航和布局
2. ✅ 更强的讨论功能 - 评论区有充足空间
3. ✅ 更好的性能 - 按需加载内容
4. ✅ 更易于分享 - 每个题目独立URL
5. ✅ 更易于扩展 - 独立页面便于添加功能

**这是一个更符合现代Web应用设计的方案！** 🚀

